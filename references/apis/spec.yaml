info:
  title: net2phone API
  description: |
    <style>
    li {
      font-size: var(--font-size-regular);
    }
    </style>

    # Getting Started

    The net2phone API is an HTTP web service that provides programmatic access to selected features of your net2phone account. It empowers you with the ability to create your integrations using our communication data resources, for example, call data records that contain details about phone calls.

    To obtain the credentials needed for authentication and make your first request against our API, follow the steps below. And if you have any issues along the way, please reach out to [integrations@net2phone.com](mailto:integrations@net2phone.com) and we will be glad to help.

    <h3> 1. Fill The Form </h3>

    The first thing you will need is credentials for your application. The required application credentials consist of a **Client ID** and **Client Secret** which can be created by filling up the contact form on our home page. You'll have an option to provide a `Redirect URL` to your application. Make sure to access our [Authentication Documentation](authentication.md) to decide if you need that.

    <h3> 2. Client Id and Client Secret </h3>

    You will shortly receive an email from us with the credentials you need. These keys are unique to your application. Please keep your **Client Secret** hidden. You will exchange these keys for an **Access Token** that will permit you to make requests against the net2phone API. You may have to use only **Client Id** or both **Id** and **Secret**.

    <h3> 3. API Request </h3>

    Once you have an Access Token you can make API Requests against the net2phone API. Below is an example of how to request the `Current User` endpoint using your **Access Token** in the Authorization header.

    *Note. Pay attention to the Accept header which is used for API versioning.*

    <h4> Request </h4>

    ```bash
    curl -X GET
    -H 'Accept:application/vnd.integrate.v1.9.0+json'
    -H 'Authorization: Bearer <ACCESS TOKEN>'
    https://integrate.versature.com/api/users/current/
    ```

    <h4> Response </h4>

    ```json
    HTTP/1.1 200 OK
    {
      "username": "1234",
      "user": "1234",
      "domain": "1234567",
      "last_name": "Smith",
      "first_name": "Joe",
      "email": "noreply@net2phone.ca",
      "scope": "basic user"
    }
    ```

    <h3> 4. What's Next? </h3>

    Now that you have a feel for Net2Phone API we recommend that you:
      - Have a look through our [API Documentation](/apis) to see all the data that is available to you.
      - Review the [Authentication Documentation](/documentation/authentication) to ensure you select the authentication flow which is best for your application.

    <br />
    <hr />
    <br />
    <hr />

    # Authentication

    The net2phone API uses the industry-standard OAuth 2.0 for authorization. If you are unfamiliar with this protocol, please take a moment to do so by visiting [OAuth 2.0](https://oauth.net/2/).

    On the [same page](https://oauth.net/code/) you will find libraries in different languages that will help to implement OAuth 2.0 based auth.

    <h3>Table of Contents</h3>

    - [Choosing The Authentication Flow](#choosing-the-authentication-flow)
    - [Authorization Code Grant](#authorization-code-grant)
      - [Authentication Steps](#authentication-steps)
    - [Resource Owner Password](#resource-owner-password)
      - [Authentication Steps](#authentication-steps-1)
    - [Implicit](#implicit)
      - [Authentication Steps](#authentication-steps-2)
    - [Token Types](#token-types)
      - [Access Token](#access-token)
      - [Refresh Token](#refresh-token)
        - [Authentication Steps](#authentication-steps-3)
      - [Responses](#responses)
    
    <h2 id="choosing-the-authentication-flow"> Choosing The Authentication Flow </h2>

    | Authentication Flow | Type of Application | Application Example |
    | -------- | ------------------- | ------------------- |
    | Authorization Code Flow | Web application with access to the backend code | An application that allows net2phone users to get a list of their calls and add information into each one |
    | Resource Owner Password Flow | Background service (machine-to-machine) | A background job that processes all account CDRs each month and exports it to an email |
    | Implicit Flow | Front-end only applications or native apps | A Single Page Application that gets a list of all calls for a specific user and allow the user to filter and download it |
    
    <br />
    <hr />
    
    <h2 id="authorization-code-grant"> Authorization Code Grant </h2>
    
    In this type of grant, your server-side application changes an Authorization Code for an **Access Token**. To use this flow, you will need to fill out the form and register a redirect URL with N2P to acquire the Client ID and secret.

    Once that is done, your application will direct users to the authorization endpoint with their Client ID and redirect URL where they will be able to authenticate with their N2P credentials. After being authenticated, the users will be redirected to your redirect URL and a unique code will be provided. Your backend server will use this code along with your Client ID, Client Secret, and redirect URL to obtain an **Access** and **Refresh Token** for the authenticated user.

    [ADD IMAGE HERE]()

    <h3 id="authentication-steps"> Authentication Steps </h3>

    1. A user clicks Login within your application
    2. Redirect the user to the authorization endpoint `https://integrate.versature.com/oauth/authorize/` with the following parameters:
      
    | Field | Type | Description |
    | -------- | ------------------- | ------------------- |
    | response_type | string | Use the value `code` |
    | client_id | string | Your integration unique client ID |
    | redirect_uri | string | Your redirect url |
    | state | string (Optional) | Value used by the client to maintain state between the request and the callback. |

    So, the redirect endpoint will end up looking like this:
    
    ```
    https://integrate.versature.com/api/oauth/authorize/?response_type=code&client_id=0123456789&redirect_uri=https://www.example.com/callback/&state=a0b1c2d3e4f5g6h7i8j9
    ```

    3. The user will authenticate with their N2P credentials and allow the access

    [ADD IMAGE HERE]()

    4. The user will then be redirected to your redirect URL with a temporary code (valid for 60 seconds only) and the state (if supplied).

    5. Your integration will then request an Access Token and a Refresh Token for the user with a POST request the following endpoint with your Client ID, code, and redirect URL:
    
    ```
    curl -X POST
    -H 'Accept:application/vnd.integrate.v1.9.0+json'
    -H 'Authorization: Bearer <**ACCESS TOKEN**>'
    <https://integrate.versature.com/api/oauth/token/>
    -d $'{
      "grant_type":"authorization_code",
      "code": "a1b2c3d4e5f6g7h8i9j0",
      "client_id": "1234567890",
      "redirect_uri": "<https://developer.net2phone.com/">
    }'
    ```

    <br />
    <hr />
    
    <h2 id="resource-owner-password"> Resource Owner Password </h2>

    If you are creating a backend service, please contact us to create a **special admin user** and be able to use the Password Authentication Flow. If you are a Unite client, there is no need to contact us, you can simply create users through net2phone web app. So, in this case, you can use an existing one or create a new one just for this purpose.

    NOTE. This flow is **NOT** supposed to be used for interactive/user authentication. If you want to request net2phone username/password from users, please use **Authorization Code Grant** flow.

    [ADD IMAGE HERE]()

    <h3 id="authentication-steps-1"> Authentication Steps </h3>

    1. Contact net2phone to create a special admin user or, if you are a Unite client, you can create your own in the net2phone web app.
    2. Stores the username and password securely in the backend service configuration.
    3. To obtain the Access Token, your integration will POST a request to the following endpoint with the special admin user username, password, client_id, client_secret, and grant_type:

    ```
    curl -X POST
    -H 'Accept:application/vnd.integrate.v1.9.0+json'
    -H 'Authorization: Bearer <**ACCESS TOKEN**>'
    <https://integrate.versature.com/api/oauth/token/>
    -d $'{
      "grant_type":"password",
      "username": "5067",
      "password": "your_awesome_password!"
      "client_id": "1234567890",
      "client_secret": "JgsSbZQfw6CVPaIJpkjfTTvPGfBq1sBAWVpGvaRlEt0TAuvfO0"
    }'
    ```

    <br />
    <hr />

    <h2 id="implicit"> Implicit </h2>

    In this flow, your front-end application will redirect the user to the net2phone authorization endpoint. The user will add his credentials and give permission to the application. Then they will be redirected to your redirect URL with the access token in the URL fragment.

    [ADD IMAGE HERE]()

    <h3 id="authentication-steps-2"> Authentication Steps </h3>

    1. A user clicks Login within your application

    2. Redirect the user to the authorization endpoint `https://integrate.versature.com/oauth/authorize/` with the following parameters:
      
    | Field | Type | Description |
    | -------- | ------------------- | ------------------- |
    | response_type | string | Use the value `token` |
    | client_id | string | Your integration unique client ID |
    | redirect_uri | string | Your redirect url |
    
    So, the redirect endpoint will end up looking like this:
    
    ```
    https://integrate.versature.com/api/oauth/authorize/?response_type=token&client_id=0123456789&redirect_uri=https://www.example.com/callback/
    ```

    3. The user will authenticate with their N2P credentials and allow the access

    [ADD IMAGE HERE]()

    4. The user will then be redirected to your redirect URL with the Access Token in the URL fragment.  It will contain:
    
    | Field | Type | Description |
    | -------- | -------- | -------- |
    | user_id | string | The user ID |
    | access_token | string | The access token to be used in the Authorization header when making requests |
    | expires | string | The datetime of the access token expiration |
    | expires_in | integer | The access token expiration time in seconds relative to the current time |
      
    Example:
    ```
    https://www.example.com/callback/#user_id=5067&access_token=fIYYaIaHkCgcaKpiM4-pKzzraojwPlUkNwGwPCptkjIED-tbBMX0miI40BJ8F-biTDZ3VfD-fwycrn-Guf9cTdFxqZ3ChxrvswldmUenyWPoxLQaNNXy10bhp4KCCIN92KN3954axuTAxZE8&expires=2021-11-04T20%3A08%3A16.326311&expires_in=3597
    ```

    <br />
    <hr />

    <h2 id="token-types"> Token Types </h2>

    <h3 id="access-token"> Access Token </h3>

    Is a specific string created by the net2phone’s server and used to inform net2phone API that the client has been authorized to access the endpoints and perform actions according to its scope.

    <h3 id="refresh_token"> Refresh Token </h3>

    As the name implies, this token allows obtaining a new **Access Token** without re-entering the client’s credentials.

    *Note. In this case, the Authorization header takes the B64 encoded string of the Client ID and Client Secret with a colon (`:`) in between as the Bearer token. So it will be like this: `client_id:client_secret`.*

    *Example:*
    *a. regular string (before encoding): `1234567890:JgsSbZQfw6CVPaIJpkjfTTvPGfBq1sBAWVpGvaRlEt0TAuvfO0`*

    *b. b64 string (after encoding): `MTIzNDU2Nzg5MDpKZ3NTYlpRZnc2Q1ZQYUlKcGtqZlRUdlBHZkJxMXNCQVdWcEd2YVJsRXQwVEF1dmZPMA==`*

    <h4 id="authentication-steps-3"> Authentication Steps </h4>

    Your integration will POST a request to the following endpoint with the grant type and the refresh_token.

    ```
    curl -X POST
    -H 'Accept:application/vnd.integrate.v1.9.0+json'
    -H 'Authorization: Bearer <B64 ENCODED CREDENTIALS>'
    <https://integrate.versature.com/api/oauth/token/>
    -d $'{
      "grant_type":"refresh_token",
      "refresh_token": "ABC382SH4028FKWNF7WGSKWI"
    }'
    ```

    *Note. New **Access Tokens** can be obtained upon expiry with the use of the Refresh Token grant. Once the ••Refresh Token•• expires, users will have to re-authenticate to obtain a new set of Tokens.*

    <h3 id="responses"> Responses </h3>

    With the exception of the `Implicit Flow` , all flows' responses will contain:

    | Field | Type | Description |
    | -------- | -------- | -------- |
    | user_id | string | The user ID |
    | access_token | string | The access token to be used in the Authorization header when making requests |
    | expires | string | The datetime of the access token expiration |
    | expires_in | integer | The access token expiration time in seconds relative to the current time |
    | refresh_token | string | The refresh token to be used when a the access token has expired |
    
    ```
    HTTP/1.1 200 OK
    {
    "user_id": "123",
    "access_token": "0l9k8j7h6g5f4d3s2a1", 
    "expires": "2021-10-15T15:44:54.058887", 
    "expires_in": 3599, 
    "refresh_token": "a1b2c3d4e5"
    }
    ```

  version: "1.9.0"
servers:
  # - url: https://integrate.versature.com/api
    # description: Production net2phone integrate API endpoint
  - url: https://versature-integrate-2-test.appspot.com/api
    description: Test net2phone integrate API endpoint

  #   description: Developement environment API endpoint
#components:
#  schemas:
#    securitySchemes:
#      oauth:
#        type: oath
#        flow: accessCode
#        authorizationUrl: https://example.com/oauth/authorize
#        tokenUrl: https://example.com/oauth/token
#        description: Authorization header using the Bearer scheme.
#        scopes:
#          openid: OpenID
#          email: Email
#          profile: Profile
#          api: API
security:
  - password: []
#  - oauth: []
